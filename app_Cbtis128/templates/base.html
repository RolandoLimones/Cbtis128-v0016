{% load static %}
<!DOCTYPE html>
<html lang="es">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
        <meta name="HandheldFriendly" content="true">
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>CBTIS 128</title>
        <link rel="stylesheet" href="{% static 'css/base.css' %}">
        <link rel="icon" href="{% static 'imagenes/iconos/favicon.ico' %}">
        <link rel="shortcut icon" href="{% static 'imagenes/favicon.ico' %}" type="image/x-icon">

         {# ESTILOS DEL LOADER #}
         <style>
            /* Estilos para el loader */
            .loader {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: white;
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 9999;
                transition: opacity 0.5s ease-out;
            }

            /* Contenedor de las ondas */
            .wave-container {
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 12px;
            }

            /* Estilos para las barras de onda */
            .wave-bar {
                width: 8px;
                height: 40px;
                background-color: #8B0000; /* Color guinda */
                border-radius: 4px;
                animation: wave 1.2s ease-in-out infinite;
            }

            /* Retrasos para cada barra para crear el efecto de onda */
            .wave-bar:nth-child(1) { animation-delay: 0s; }
            .wave-bar:nth-child(2) { animation-delay: 0.1s; }
            .wave-bar:nth-child(3) { animation-delay: 0.2s; }
            .wave-bar:nth-child(4) { animation-delay: 0.3s; }
            .wave-bar:nth-child(5) { animation-delay: 0.4s; }

            /* Animación de las ondas */
            @keyframes wave {
                0%, 40%, 100% {
                    transform: scaleY(0.4);
                }
                20% {
                    transform: scaleY(1);
                }
            }

            /* Clase para ocultar el loader */
            .loader.hidden {
                opacity: 0;
                pointer-events: none;
            }
        </style>
        
        {# AÑADIDO: Bloque para CSS adicional, se carga en el HEAD #}
        {% block extra_css %}
        {% endblock %}
        
    </head>
    <body>

                <!-- LOADER - Se muestra al cargar la página -->
                <div class="loader" id="loader">
                    <div class="wave-container">
                        <div class="wave-bar"></div>
                        <div class="wave-bar"></div>
                        <div class="wave-bar"></div>
                        <div class="wave-bar"></div>
                        <div class="wave-bar"></div>
                    </div>
                </div>


        <div id="fb-root"></div>
        {# Se recomienda cambiar 'APP_ID' por el ID real de tu aplicación de Facebook #}
        <script async defer crossorigin="anonymous" src="https://connect.facebook.net/es_ES/sdk.js#xfbml=1&version=v24.0&appId=APP_ID"></script>
        
        {% include 'nav.html' %}
        
        <main>
            {% block content %}
            {% endblock %}
        </main>
        
        {% include 'footer.html' %}
        <script src="{% static 'script/script.js' %}"></script>

         {# SCRIPT PARA EL LOADER #}
         <script>
            // Función para mostrar el loader
            function mostrarLoader() {
                const loader = document.getElementById('loader');
                loader.classList.remove('hidden');
            }

            // Función para ocultar el loader
            function ocultarLoader() {
                const loader = document.getElementById('loader');
                loader.classList.add('hidden');
            }

            // Ocultar loader cuando la página termine de cargar
            window.addEventListener('load', function() {
                // Pequeño delay para asegurar que todo esté cargado
                setTimeout(() => {
                    ocultarLoader();
                }, 500);
            });

            // Mostrar loader cuando se hace clic en enlaces (navegación)
            document.addEventListener('DOMContentLoaded', function() {
                const links = document.querySelectorAll('a[href]');
                
                links.forEach(link => {
                    link.addEventListener('click', function(e) {
                        // No mostrar loader para enlaces externos o que abren en nueva pestaña
                        if (this.target === '_blank' || 
                            this.href.startsWith('javascript:') || 
                            this.href.startsWith('mailto:') || 
                            this.href.startsWith('tel:')) {
                            return;
                        }
                        
                        // No mostrar loader para enlaces ancla (misma página)
                        if (this.getAttribute('href').startsWith('#')) {
                            return;
                        }
                        
                        // Mostrar loader para navegación interna
                        mostrarLoader();
                    });
                });
            });

            // Manejar navegación con el botón de retroceso/avance del navegador
            window.addEventListener('popstate', function() {
                mostrarLoader();
                setTimeout(ocultarLoader, 500);
            });
        </script>
        
        {# AÑADIDO: Bloque para JavaScript adicional, se carga al final del BODY #}
        {% block extra_js %}
        {% endblock %}
    </body>
</html>